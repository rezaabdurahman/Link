# API Gateway Enhanced Configuration Example

# Server Configuration
PORT=:8080
LOG_LEVEL=info
SHUTDOWN_TIMEOUT=30s

# Service Discovery Configuration
# Format for service instances: SERVICE_NAME_INSTANCES=id1:url1:health_url1:weight:timeout,id2:url2:health_url2:weight:timeout

# User Service Instances
USER_SVC_INSTANCES=user-1:http://user-svc-1:8080:http://user-svc-1:8080/health:100:30s,user-2:http://user-svc-2:8080:http://user-svc-2:8080/health:100:30s,user-3:http://user-svc-3:8080:http://user-svc-3:8080/health:100:30s

# Chat Service Instances
CHAT_SVC_INSTANCES=chat-1:http://chat-svc-1:8080:http://chat-svc-1:8080/health:100:30s,chat-2:http://chat-svc-2:8080:http://chat-svc-2:8080/health:100:30s

# AI Service Instances
AI_SVC_INSTANCES=ai-1:http://ai-svc-1:8080:http://ai-svc-1:8080/health:100:45s,ai-2:http://ai-svc-2:8080:http://ai-svc-2:8080/health:100:45s

# Search Service Instances
SEARCH_SVC_INSTANCES=search-1:http://search-svc-1:8080:http://search-svc-1:8080/health:100:30s,search-2:http://search-svc-2:8080:http://search-svc-2:8080/health:100:30s

# Discovery Service Instances
DISCOVERY_SVC_INSTANCES=discovery-1:http://discovery-svc-1:8080:http://discovery-svc-1:8080/health:100:30s

# Load Balancer Configuration
# Load balancing strategy: round_robin, random, least_connections
USER_SVC_LOAD_BALANCE_STRATEGY=round_robin
CHAT_SVC_LOAD_BALANCE_STRATEGY=round_robin
AI_SVC_LOAD_BALANCE_STRATEGY=least_connections
SEARCH_SVC_LOAD_BALANCE_STRATEGY=round_robin
DISCOVERY_SVC_LOAD_BALANCE_STRATEGY=round_robin

# Circuit Breaker Configuration
# Format: failure_threshold:success_threshold:timeout
USER_SVC_CIRCUIT_BREAKER=5:3:60s
CHAT_SVC_CIRCUIT_BREAKER=5:3:60s
AI_SVC_CIRCUIT_BREAKER=3:2:120s
SEARCH_SVC_CIRCUIT_BREAKER=5:3:60s
DISCOVERY_SVC_CIRCUIT_BREAKER=5:3:60s

# Retry Configuration
# Format: max_attempts:initial_delay:max_delay:backoff_multiplier
USER_SVC_RETRY=3:100ms:5s:2.0
CHAT_SVC_RETRY=3:100ms:5s:2.0
AI_SVC_RETRY=2:200ms:10s:2.0
SEARCH_SVC_RETRY=3:100ms:5s:2.0
DISCOVERY_SVC_RETRY=3:100ms:5s:2.0

# Health Check Configuration
# Format: interval:timeout:initial_delay
USER_SVC_HEALTH_CHECK=30s:10s:5s
CHAT_SVC_HEALTH_CHECK=30s:10s:5s
AI_SVC_HEALTH_CHECK=30s:15s:10s
SEARCH_SVC_HEALTH_CHECK=30s:10s:5s
DISCOVERY_SVC_HEALTH_CHECK=30s:10s:5s

# Kubernetes Service Discovery (alternative to explicit instances)
# Set to true to use Kubernetes DNS-based service discovery
USE_KUBERNETES_DISCOVERY=false
KUBERNETES_NAMESPACE=default

# Service DNS names when using Kubernetes discovery
USER_SVC_DNS=user-svc.default.svc.cluster.local
CHAT_SVC_DNS=chat-svc.default.svc.cluster.local
AI_SVC_DNS=ai-svc.default.svc.cluster.local
SEARCH_SVC_DNS=search-svc.default.svc.cluster.local
DISCOVERY_SVC_DNS=discovery-svc.default.svc.cluster.local
